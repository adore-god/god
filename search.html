<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<link href="https://god.thway.uk/search.html" rel="canonical">
<meta content="width=device-width, initial-scale=1.0" name="viewport">
<link rel="preconnect" href="https://www.blueletterbible.org" crossorigin><link rel="dns-prefetch" href="https://www.blueletterbible.org">
<link href="favicon.png" rel="icon" type="image/png">
<link rel="manifest" href="manifest.json">
<link href="style.css" rel="stylesheet">
<link rel="stylesheet" href="style-fonts.css" media="print" onload="this.media='all'">
<script src="https://www.blueletterbible.org/assets-v3/scripts/blbToolTip/BLB_ScriptTagger-min.js"></script><script>
// Additional settings
BLB.Tagger.Translation = 'BBE';
BLB.Tagger.HyperLinks = 'hover'; // 'all', 'none', 'hover'
BLB.Tagger.HideTranslationAbbrev = true;
BLB.Tagger.TargetNewWindow = true;
BLB.Tagger.Style = 'line'; // 'line' or 'par'
BLB.Tagger.NoSearchTagNames = 'h1,h2,h3,h4'; // HTML element list
BLB.Tagger.NoSearchClassNames = 'noTag doNotTag sidebar'; // CSS class list
</script>
<script src="script.js"></script>
<script src="latest-arts.js"></script>
<!-- Google tag (gtag.js) -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-Z5M83Q78Z0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Z5M83Q78Z0');
</script>
<title>Search</title>
</head>
<body>
<div class="header"><a href="https://god.thway.uk">The Way</a><button id="theme-toggle">&#9680;</button><script src="script-dark-light.js"></script>
</div>
<h1>Search</h1>
<div class="container">

<!-- Custom search box -->
<div id="custom-search-container">
  <input type="text" id="custom-search-input" placeholder="Search site with Google">
  <button id="custom-search-button">Search</button>
</div>

<!-- Where the results will appear -->
<div id="custom-search-results">
  <gcse:searchresults-only></gcse:searchresults-only>
</div>

<!-- Load Google CSE -->
<script async src="https://cse.google.com/cse.js?cx=62434d5e426ae403f"></script>

<script>
function performSearch() {
  var query = document.getElementById("custom-search-input").value;

  // Execute search only if Google CSE is loaded
  if (window.google && google.search && google.search.cse && google.search.cse.element) {
    var element = google.search.cse.element.getElement('searchresults-only0');
    if (element) {
      element.execute(query);
    }
  }
}

// Trigger search on button click
document.getElementById("custom-search-button").addEventListener("click", performSearch);

// Trigger search on pressing Enter
document.getElementById("custom-search-input").addEventListener("keypress", function(e) {
  if (e.key === 'Enter') {
    performSearch();
  }
});
</script>

<input type="text" id="searchBox" placeholder="Site Search...">
<div class="srch-series-link">
<a href="series-links.html">Series and Collections</a> <br> 
</div>
<ul id="results"></ul>

<div class="latest-posts">
<h4 class="center">Latest Updates </h4> 
<div id="latest-posts"></div>
</div> 

<script>
document.addEventListener('DOMContentLoaded', () => {
  const containerSelectors = ['#results', '#latest-posts'];

  // Add class to an element or to all anchors inside an element
  function addNoTagToElement(el) {
    if (!el) return;
    if (el.tagName === 'A') el.classList.add('noTag');
    if (el.querySelectorAll) el.querySelectorAll('a').forEach(a => a.classList.add('noTag'));
  }

  // Initial pass: add to existing anchors in the containers
  containerSelectors.forEach(sel => {
    const c = document.querySelector(sel);
    if (c) addNoTagToElement(c);
  });

  // Watch the containers for new nodes and add the class to any new anchors
  containerSelectors.forEach(sel => {
    const c = document.querySelector(sel);
    if (!c) return;
    const observer = new MutationObserver(mutations => {
      for (const m of mutations) {
        for (const node of m.addedNodes) {
          if (node.nodeType !== Node.ELEMENT_NODE) continue;
          addNoTagToElement(node);
        }
      }
    });
    observer.observe(c, { childList: true, subtree: true });
  });

  // --- Your search code (unchanged behaviour) ---
  async function loadIndex() {
    try {
      const response = await fetch('searchIndex.json');
      if (!response.ok) throw new Error('Failed to fetch searchIndex.json: ' + response.status);
      return await response.json();
    } catch (e) {
      console.error(e);
      return [];
    }
  }

  const searchBox = document.getElementById('searchBox');
  const resultsList = document.getElementById('results');

  if (searchBox && resultsList) {
    searchBox.addEventListener('input', async function () {
      const query = this.value.trim().toLowerCase();
      resultsList.innerHTML = '';
      if (!query) return;

      const index = await loadIndex();
      const results = index.filter(page =>
        page.title.toLowerCase().includes(query) ||
        page.content.toLowerCase().includes(query)
      );

      results.forEach(page => {
        const li = document.createElement('li');
        const a = document.createElement('a');
        a.href = page.url;
        a.textContent = page.title;
        a.classList.add('noTag'); // <- the only change: ensure every generated link gets the class
        li.appendChild(a);
        resultsList.appendChild(li);
      });

      // safety pass
      addNoTagToElement(resultsList);
    });
  } else {
    console.warn('#searchBox or #results not found — search listener not attached');
  }
});
</script>


</div>
<div class="footer">© 2025 <a href="https://god.thway.uk/">God - The Way</a>. All rights reserved. Use for AI training or reproduction is not permitted.</div>
</body>
</html>
